<!DOCTYPE html>
<html>

<head>
    <!-- Vue -->
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <!-- Axios -->
    <script type="text/javascript" src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.x/dist/vue.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <style>
        .flip-card {
            background-color: transparent;
            width: 500px;
            height: 500px;
            border: 1px solid #f1f1f1;
            perspective: 1000px;
            align-items: center !important;
            /* Remove this if you don't want the 3D effect */
        }

        /* This container is needed to position the front and back side */
        .flip-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.8s;
            transform-style: preserve-3d;
        }

        /* Do an horizontal flip when you move the mouse over the flip box container */
        .flip-card:active .flip-card-inner {
            transform: rotateY(180deg);
        }

        /* Position the front and back side */
        .flip-card-front,
        .flip-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            /* Safari */
            backface-visibility: hidden;
        }

        /* Style the front side (fallback if image is missing) */
        .flip-card-front {
            background-color: #bbb;
            color: black;
        }

        /* Style the back side */
        .flip-card-back {
            background-color: dodgerblue;
            color: white;
            transform: rotateY(180deg);
        }
    </style>
</head>

<body>
    <div id="app">
        <v-app>
            <v-content v-if="current_view == 'cards'">
                <v-btn v-on:click="current_view='main'">Home</v-btn>
                <v-carousel height="80vh">
                    <v-carousel-item v-for="recipe in recipeInfo[0]">
                        <!-- Vuetify Card section use if flip doesn't work -->
                        <!-- <v-card class="mx-auto white" max-width="60vw" >
                            <v-img class="white--text align-end" height="30vh" v-bind:src="recipe.image">
                                
                            </v-img>
                            <v-card-title class="black--text">[[recipe.title]]</v-card-title>
                            <v-card-subtitle class="pb-0">Number 10</v-card-subtitle> -->

                        <!-- <v-card-text class="text--primary">
                                <p v-html="recipe.summary"></p>
                                <div>Whitsunday Island, Whitsunday Islands</div>
                            </v-card-text>
                        </v-card> -->
                        <v-card class="justify-center">
                            <div class="flip-card">
                                <div class="flip-card-inner">
                                    <div class="flip-card-front">
                                        <img v-bind:src="recipe.image" alt="Avatar" style="width:500px;height:500px;">

                                    </div>
                                    <div class="flip-card-back">
                                        <h2>[[recipe.title]]</h2>
                                        <p class="text-left" v-html="recipe.instructions"></p>
                                        <v-list>
                                            <v-list-item v-for="(task, i) in recipe.extendedIngredients" :key="i">
                                                <v-list-item-content v-text="task.originalString">

                                                </v-list-item-content>
                                            </v-list-item>
                                        </v-list>
                                    </div>
                                </div>
                            </div>
                        </v-card>
                    </v-carousel-item>
                </v-carousel>
            </v-content>
            <v-content v-if="current_view == 'main'">
                <v-btn v-on:click="getRandomRecipe">Random Search</v-btn>
                <v-btn v-on:click="current_view = 'filters'">Filter Search</v-btn>
            </v-content>
            <v-content v-if="current_view == 'filters'" id="filters">
                <v-btn v-on:click="current_view='main'">Cancel</v-btn>
                <v-btn v-on:click="getRecipes">Let's Go</v-btn>
                <!--  -->
                <v-select :items="meal" label="Meal" v-model="mealSelect">
                </v-select>
                <!-- [[mealSelect]] -->
                <v-select :items="diet" label="Diet" v-model="dietSelect">
                </v-select>
                <!-- [[dietSelect]] -->
                <v-select :items="intolerances" label="Intolerances" multiple v-model="intolerancesSelect">
                </v-select>
                <!-- [[intolerancesSelect]] -->
                <v-select :items="cuisine" label="Cuisine" multiple v-model="cuisineSelect">
                </v-select>
            </v-content>

        </v-app>
    </div>

    <script>
        new Vue({
            el: '#app',
            vuetify: new Vuetify(),
            delimiters: ['[[', ']]'],
            data: {
                current_view: 'main',
                meal:
                    [{ text: 'Main Course', value: 'maincourse' },
                    { text: 'Breakfast', value: 'breakfast' },
                    { text: 'Dessert', value: 'dessert' },
                    { text: 'Side Dish', value: 'sidedish' },
                    { text: 'Appetizer', value: 'appetizer' },
                    { text: 'Salad', value: 'salad' },
                    { text: 'Bread', value: 'bread' },
                    { text: 'Soup', value: 'soup' },
                    { text: 'Finger Food', value: 'fingerfood' },
                    { text: 'Snack', value: 'snack' },
                    { text: 'Beverage', value: 'beverage' }],
                diet:
                    [{ text: 'Gluten Free', value: 'glutenfree' },
                    { text: 'Ketogenic', value: 'ketogenic' },
                    { text: 'Vegetarian', value: 'vegetarian' },
                    { text: 'Lacto-Vegetarian', value: 'lacto-vegetarian' },
                    { text: 'Ovo-Vegetarian', value: 'ovo-vegetarian' },
                    { text: 'Vegan', value: 'vegan' },
                    { text: 'Pescetarian', value: 'pescetarian' },
                    { text: 'Paleo', value: 'paleo' },
                    { text: 'Primal', value: 'primal' },
                    { text: 'Whole30', value: 'whole30' }],
                intolerances:
                    [{ text: 'Dairy', value: 'dairy' },
                    { text: 'Egg', value: 'egg' },
                    { text: 'Gluten', value: 'gluten' },
                    { text: 'Grain', value: 'grain' },
                    { text: 'Peanut', value: 'peanut' },
                    { text: 'Seafood', value: 'seafood' },
                    { text: 'Sesame', value: 'sesame' },
                    { text: 'Shellfish', value: 'shellfish' },
                    { text: 'Soy', value: 'soy' },
                    { text: 'Sulfite', value: 'sulfite' },
                    { text: 'Tree Nut', value: 'treenut' },
                    { text: 'Wheat', value: 'wheat' },],
                cuisine:
                    [{ text: 'African', value: 'african' },
                    { text: 'American', value: 'american' },
                    { text: 'British', value: 'british' },
                    { text: 'Cajun', value: 'cajun' },
                    { text: 'Caribbean', value: 'caribbean' },
                    { text: 'Chinese', value: 'chinese' },
                    { text: 'Eastern European', value: 'easterneuropean' },
                    { text: 'European', value: 'european' },
                    { text: 'French', value: 'french' },
                    { text: 'German', value: 'german' },
                    { text: 'Greek', value: 'greek' },
                    { text: 'Indian', value: 'indian' },
                    { text: 'Irish', value: 'irish' },
                    { text: 'Italian', value: 'italian' },
                    { text: 'Japanese', value: 'japanese' },
                    { text: 'Jewish', value: 'jewish' },
                    { text: 'Korean', value: 'korean' },
                    { text: 'Latin American', value: 'latinamerican' },
                    { text: 'Mediterranean', value: 'mediterranean' },
                    { text: 'Mexican', value: 'mexican' },
                    { text: 'Middle Eastern', value: 'middleeastern' },
                    { text: 'Nordic', value: 'nordic' },
                    { text: 'Southern', value: 'southern' },
                    { text: 'Spanish', value: 'spanish' },
                    { text: 'Thai', value: 'thai' },
                    { text: 'Vietnamese', value: 'vietnamese' },
                    ],
                mealSelect: [],
                dietSelect: [],
                intolerancesSelect: [],
                cuisineSelect: [],
                recipeInfo: [],
                cards: [],


            },
            methods: {
                getRecipes: function () {
                    recipeInfo = []
                    axios({
                        method: 'get',
                        url: "{% url 'fudr:recipes' %}",
                        params: {
                            fillIngredients: true,
                            addRecipeInformation: true,
                            type: this.mealSelect,
                            diet: this.dietSelect,
                            intolerances: this.intolerancesSelect.join(','),
                            cuisine: this.cuisineSelect.join(',')
                        },
                    }).then(response => {
                        console.log(response.data)
                        this.recipes = response.data.data.recipes
                        this.current_view = 'cards'
                        this.mealSelect = []
                        this.dietSelect = []
                        this.intolerancesSelect = []
                        this.cuisineSelect = []
                        this.recipeInfo.push(this.recipes)
                        this.recipes = []
                        console.log(this.recipeInfo)
                    })
                },
                getRandomRecipe: function () {
                    recipeInfo = []
                    axios({
                        method: 'get',
                        url: "{% url 'fudr:randomRecipe' %}",
                        params: {},
                    }).then(response => {
                        // console.log(response.data)
                        this.recipes = response.data.data.recipes
                        this.current_view = 'cards'
                        this.recipeInfo.push(this.recipes)
                        this.recipes = []
                        console.log(this.recipeInfo)

                    })
                },

            },
            created: {

            }
        })
    </script>
</body>

</html>